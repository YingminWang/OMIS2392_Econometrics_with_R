lm3b <-lm(lnreturnvalue ~ time_group*store_group + lnsalesvalue + avg_female + avg_age + avg_income +
avg_homeowner + avg_residency +avg_childowner, data=Online_daily_store)
anova(lm3, lm3b, test='Chisq') # significant, include log(salesvalue+1) (lm3b)
#####
gqtest(lm3b)   #significant
bptest(lm3b)   # insignificant
HWrobstder3a <- sqrt(diag(vcovHC(lm3b, type='HC1')))
stargazer(lm3b, type='text',title='Online_Returnvalue', se=list(HWrobstder3a),
column.labels = c("HW-Robust SE"), df=FALSE, digits=2,
star.cutoffs = c(0.05,0.01,0.001))
## Marginal Effects
meffects3a <- ggpredict(lm3b, terms=c('time_group', 'store_group'))
## Marginal Effects
meffects3a <- ggpredict(lm3b, terms=c('time_group', 'store_group'))
ggplot(meffects3a, aes(x, predicted, color=group)) + geom_line(size=1.3) +
xlab('Time') + ylab('ln(Return Value)') +
scale_color_discrete(labels=c('Policy changed', 'Policy unchanged'))+
scale_x_continuous(breaks = c(0,1), labels = c('Before policy change', 'After policy change'))
#### Multicollinearity
df3c <- Online_daily_store[c('returnquantity','store_group','time_group', 'avg_female','avg_age','avg_income',
'avg_homeowner','avg_residency','avg_childowner','salesquantity')]
###### POISSON
poisson3 <- glm(returnquantity ~ time_group*store_group + avg_female + avg_age + avg_income +
avg_homeowner + avg_residency +avg_childowner, data=Online_daily_store, family='poisson')
poisson3b <- glm(returnquantity ~ time_group*store_group +salesquantity+ avg_female + avg_age + avg_income +
avg_homeowner + avg_residency +avg_childowner, data=Online_daily_store, family='poisson')
poisson3c <-glm(returnquantity ~ time_group*store_group +lnsalesquantity+ avg_female + avg_age + avg_income +
avg_homeowner + avg_residency +avg_childowner, data=Online_daily_store, family='poisson')
AIC(poisson3b,poisson3c)
BIC(poisson3b,poisson3c)  # log(salesquantity+1) is better(poisson3c)
anova(poisson3,poisson3c, test='Chisq')  # significant ==> with log(salesquantity+1) is better(poisson3c)
stargazer(poisson3b, type='text', title='Q3-returnquantity-poisson', column.labels = 'poisson-IRR',
apply.coef = exp, t.auto = F, p.auto = F,
df=FALSE, digits=2, star.cutoffs = c(0.05,0.01,0.001))
# return policy change will decrease return quantity by 19%.
### HETEROSKEDASTICITY
bptest(poisson3c)   # significant
gqtest(poisson3c)   # significant
HWrobstder3b <- sqrt(diag(vcov(poisson3c, type='HC1')))
stargazer(poisson3c, poisson3c, type='text', title='Q3-returnquantity-poisson-IRR',
apply.coef = exp, t.auto = F, p.auto = F,
se=list(NULL, HWrobstder3b), column.labels = c("Normal SE", "HW-Robust SE"),
df=FALSE, digits=2, star.cutoffs = c(0.05,0.01,0.001))
#### MODEL FIT
poisson3a <- glm(returnquantity~1, data=Online_daily_store,family='poisson')
lrtest(poisson3c, poisson3a)
######## NEGATICE BINOMIAL
negbin3 <- glm.nb(returnquantity ~ time_group*store_group + avg_female + avg_age + avg_income +
avg_homeowner + avg_residency +avg_childowner, data=Online_daily_store)
negbin3b <-glm.nb(returnquantity ~ time_group*store_group +lnsalesquantity+ avg_female + avg_age + avg_income +
avg_homeowner + avg_residency +avg_childowner, data=Online_daily_store)
lrtest(negbin3, negbin3b)
stargazer(negbin3b, type='text', title='Q3-returnquantity-NB', column.labels = 'negative binomial-IRR',
apply.coef = exp, t.auto = F, p.auto = F,
df=FALSE, digits=2, star.cutoffs = c(0.05,0.01,0.001))
###### HETEROSKEDASTICITY
gqtest(negbin3b)  # significant
bptest(negbin3b)  # significant
HWrobstder3c <- sqrt(diag(vcov(negbin3b, type='HC1')))
stargazer(negbin3b, type='text', title='Online_Returnquantity',
apply.coef = exp, t.auto = F, p.auto = F,
se=list(HWrobstder3c), column.labels = c("HW-Robust SE"),
df=FALSE, digits=2, star.cutoffs = c(0.05,0.01,0.001))
#### MODEL fit
negbin3a <- glm.nb(returnquantity ~1, data =Online_daily_store)
lrtest(negbin3b, negbin3a)   # significant, NB model fits the data
###### CHOOSE MODEL
lrtest(poisson3c, negbin3b) # significant, NB model is better
#### Marginal Effects
meffects3b <- ggpredict(negbin3b, terms=c('time_group', 'store_group'))
ggplot(meffects3b, aes(x, predicted, color=group)) + geom_line(size=1.3) +
xlab('Time') + ylab('Return Quantity') +
scale_color_discrete(labels=c('Policy changed', 'Policy unchanged'))+
scale_x_continuous(breaks = c(0,1), labels = c('Before policy change', 'After policy change'))
#=========
# Conclusion: change of return policy has insignificant impact on online store returnvalue,
#                                       but will decrease return quantity by 11%
#=========
```
ggplot(meffects3b, aes(x, predicted, color=group)) + geom_line(size=1.3) +
xlab('Time') + ylab('Return Quantity') +
scale_color_discrete(labels=c('Policy changed', 'Policy unchanged'))+
scale_x_continuous(breaks = c(0,1), labels = c('Before policy change', 'After policy change'))
stargazer(Online_daily_prod, type='text', title='descriptive analysis',
digits=2, median=TRUE, iqr=TRUE)
lm5a <- lm(lnsalesvalue ~ time_group*store_group + avg_female + avg_age + avg_income +
avg_homeowner + avg_residency +avg_childowner +fproduct_category,
data=Online_daily_prod)
step<-stepAIC(lm5a, direction='both')
step$anova
lm5b<- lm(lnsalesvalue ~ time_group*store_group + avg_female + avg_age + avg_income +
avg_homeowner +avg_childowner+fproduct_category, data=Online_daily_prod)
anova(lm5a,lm5b, test='Chisq')
lm5<-lm(lnsalesvalue ~ time_group*store_group + avg_female + avg_age + avg_income +
avg_homeowner +avg_childowner+ avg_residency+fproduct_category,
data=Online_daily_prod)
stargazer(lm5, type='text',title='regression result',
column.labels = 'lm1a', df=FALSE, digits=2, star.cutoffs = c(0.05,0.01,0.001))
##### Heteroskedasticity
gqtest(lm5) # significant
bptest(lm5) # significant
HWrobstder5a <- sqrt(diag(vcovHC(lm5, type='HC1')))
stargazer(lm5, type='text',title='Online_Salesvalue', se=list(HWrobstder5a),
column.labels = c("HW-Robust SE"), df=FALSE, digits=2,
star.cutoffs = c(0.05,0.01,0.001))
#### Marginal Effect
meffects5a <- ggpredict(lm5, terms=c('time_group', 'store_group'))
ggplot(meffects5a, aes(x, predicted, color=group)) + geom_line(size=1.3) +
xlab('Time') + ylab('ln(Sales Value)') +
scale_color_discrete(labels=c('Policy changed', 'Policy unchanged'))+
scale_x_continuous(breaks = c(0,1), labels = c('Before policy change', 'After policy change'))
####  poisson model
poisson5a <- glm(salesquantity~ time_group*store_group + avg_female + avg_age + avg_income +
avg_homeowner + avg_residency +avg_childowner+fproduct_category,
data=Online_daily_prod, family = 'poisson')
poisson5b <-glm(salesquantity~ time_group*store_group + avg_female + avg_age + avg_income +
avg_homeowner +avg_childowner+fproduct_category,
data=Online_daily_prod, family = 'poisson')
anova(poisson5a, poisson5b, test='Chisq')
stargazer(poisson5a, type='text', title='Online_salesquantity', column.labels ='poisson5a',
apply.coef = exp, t.auto=F, p.auto=F,
digits=2, df=FALSE, star.cutoffs=c(0.05,0.01,0.001) )
## model fit
poisson5c <- glm(salesquantity~1, data=Online_daily_prod, family='poisson')
lrtest(poisson5a,poisson5c)
### Heteroskedasticity
bptest(poisson5a)
gqtest(poisson5a)
HWrobstder5b <- sqrt(diag(vcovHC(poisson5a, type='HC1')))
stargazer(poisson5a, type='text', title='Online_salesquantity',
column.labels ='poisson5a-IRR-robust SE',
apply.coef = exp, t.auto=F, p.auto=F,
se=list(HWrobstder5b),
digits=2, df=FALSE, star.cutoffs=c(0.05,0.01,0.001) )
####  negative binomial model
negbin5a <- glm.nb(salesquantity ~ time_group*store_group + avg_female + avg_age + avg_income +
avg_homeowner + avg_residency +avg_childowner+fproduct_category,
data=Online_daily_prod)
negbin5b <- glm.nb(salesquantity ~ time_group*store_group + avg_female + avg_age + avg_income +
avg_homeowner + avg_childowner+fproduct_category,
data=Online_daily_prod)
lrtest(negbin5a, negbin5b)
stargazer(negbin5b,  title="Online_salesquantity", type="text", column.labels=c("negbin5b-IRR"),
apply.coef = exp, t.auto=F, p.auto=F,
df=FALSE, digits=2, star.cutoffs = c(0.05,0.01,0.001))
### Heterosckedasticity
gqtest(negbin5b)    #significant
bptest(negbin5b)    #significant
HWrobstder5c<- sqrt(diag(vcovHC(negbin5b, type='HC1')))
stargazer(negbin5b,  title="Online_Salesquantity", type="text", column.labels=c("negbin5b-IRR-robust SE"),
apply.coef = exp, t.auto=F, p.auto=F,
se=list(HWrobstder5c),
df=FALSE, digits=2, star.cutoffs = c(0.05,0.01,0.001))
### MODEL FIT
negbin5c <- glm.nb(salesquantity~1, data=Online_daily_prod)
lrtest(negbin5c, negbin5b)  #significant==> negative binomial model fits the data
######## CHOOSE MODEL BETWEEN POISSON & NEGATIVE BINOMIAL
lrtest(poisson5a, negbin5b)
meffects5b <- ggpredict(negbin5b, terms=c('time_group', 'store_group'))
ggplot(meffects5b, aes(x, predicted, color=group)) + geom_line(size=1.3) +
xlab('Time') + ylab('Sales Quantity') +
scale_color_discrete(labels=c('Policy changed', 'Policy unchanged'))+
scale_x_continuous(breaks = c(0,1), labels = c('Before policy change', 'After policy change'))
stargazer(Online_daily_prod, type='text', title='descriptive analysis',
digits=2, median=TRUE, iqr=TRUE)
#### linear regression
lm5d <- lm(lnreturnvalue ~ time_group*store_group + avg_female + avg_age + avg_income +
avg_homeowner + avg_residency +avg_childowner+fproduct_category,
data=Online_daily_prod)
step <- stepAIC(lm5d, direction='both')
step$anova
lm5e <- lm(lnreturnvalue ~ time_group*store_group + lnsalesvalue+ avg_female + avg_age +
avg_income + avg_homeowner + avg_residency +avg_childowner+fproduct_category,
data=Online_daily_prod)
ggplot(meffects5b, aes(x, predicted, color=group)) + geom_line(size=1.3) +
xlab('Time') + ylab('Sales Quantity') +
scale_color_discrete(labels=c('Policy changed', 'Policy unchanged'))+
scale_x_continuous(breaks = c(0,1), labels = c('Before policy change', 'After policy change'))
stargazer(Online_daily_prod, type='text', title='descriptive analysis',
digits=2, median=TRUE, iqr=TRUE)
#### linear regression
lm5d <- lm(lnreturnvalue ~ time_group*store_group + avg_female + avg_age + avg_income +
avg_homeowner + avg_residency +avg_childowner+fproduct_category,
data=Online_daily_prod)
step <- stepAIC(lm5d, direction='both')
step$anova
lm5e <- lm(lnreturnvalue ~ time_group*store_group + lnsalesvalue+ avg_female + avg_age +
avg_income + avg_homeowner + avg_residency +avg_childowner+fproduct_category,
data=Online_daily_prod)
anova(lm5d, lm5e, test='Chisq') # significant, include lnsalesvalue (lm5e)
lm5f <- lm(lnreturnvalue ~ time_group*store_group + lnsalesvalue+ avg_female + avg_age +
avg_income + avg_homeowner +avg_childowner+fproduct_category,
data=Online_daily_prod)
anova(lm5f, lm5e, test='Chisq') # insignificant  ==> without avg_residency is better(lm5f)
lm5g <- lm(lnreturnvalue ~ time_group*store_group + lnsalesvalue+ avg_female + avg_age +
avg_income + avg_homeowner +fproduct_category,
data=Online_daily_prod)
anova(lm5f, lm5g, test='Chisq') # insignificant ==> without avg_childowner is better(lm5g)
#####
gqtest(lm5g)   #insignificant
bptest(lm5g)   # significant
HWrobstder5d <- sqrt(diag(vcovHC(lm5g, type='HC1')))
stargazer(lm5g, type='text',title='Online_Returnvalue', se=list(HWrobstder5d),
column.labels = c("HW-Robust SE"), df=FALSE, digits=2,
star.cutoffs = c(0.05,0.01,0.001))
## Marginal Effects
meffects5c <- ggpredict(lm5g, terms=c('time_group', 'store_group'))
ggplot(meffects5c, aes(x, predicted, color=group)) + geom_line(size=1.3) +
xlab('Time') + ylab('ln(Return Value)') +
scale_color_discrete(labels=c('Policy changed', 'Policy unchanged'))+
scale_x_continuous(breaks = c(0,1), labels = c('Before policy change', 'After policy change'))
stargazer(lm5g, type='text',title='Online_Returnvalue', se=list(HWrobstder5d),
column.labels = c("HW-Robust SE"), df=FALSE, digits=2,
star.cutoffs = c(0.05,0.01,0.001))
###### POISSON
poisson5d <- glm(returnquantity ~ time_group*store_group + avg_female + avg_age + avg_income +
avg_homeowner + avg_residency +avg_childowner+fproduct_category,
data=Online_daily_prod, family='poisson')
poisson5e <- glm(returnquantity ~ time_group*store_group +salesquantity+ avg_female + avg_age +
avg_income + avg_homeowner + avg_residency +avg_childowner+
fproduct_category, data=Online_daily_prod, family='poisson')
anova(poisson5d,poisson5e, test='Chisq')  # significant ==> with salesquantity is better(poisson5e)
poisson5f <-glm(returnquantity ~ time_group*store_group +lnsalesquantity+ avg_female + avg_age +
avg_income + avg_homeowner + avg_residency +avg_childowner+
fproduct_category, data=Online_daily_prod, family='poisson')
AIC(poisson5e,poisson5f)
BIC(poisson5e,poisson5f)  # lnsalesquantity is better(poisson5f)
stargazer(poisson5f, type='text', title='Online_returnquantity', column.labels = 'poisson-IRR',
apply.coef = exp, t.auto = F, p.auto = F,
df=FALSE, digits=2, star.cutoffs = c(0.05,0.01,0.001))
### HETEROSKEDASTICITY
bptest(poisson5f)   # significant
gqtest(poisson5f)   # significant
HWrobstder5e <- sqrt(diag(vcov(poisson5f, type='HC1')))
stargazer(poisson5f, type='text', title='returnquantity-poisson-IRR',
apply.coef = exp, t.auto = F, p.auto = F,
se=list(HWrobstder5e), column.labels = c("HW-Robust SE"),
df=FALSE, digits=2, star.cutoffs = c(0.05,0.01,0.001))
#### MODEL FIT
poisson5g <- glm(returnquantity~1, data=Online_daily_prod,family='poisson')
lrtest(poisson5f, poisson5g)
######## NEGATICE BINOMIAL
negbin5d <- glm.nb(returnquantity ~ time_group*store_group + avg_female + avg_age + avg_income +
avg_homeowner + avg_residency +avg_childowner+fproduct_category,
data=Online_daily_prod)
negbin5e <-glm.nb(returnquantity ~ time_group*store_group +lnsalesquantity+ avg_female + avg_age
+ avg_income + avg_homeowner + avg_residency +avg_childowner+fproduct_category,
data=Online_daily_prod)
lrtest(negbin5d, negbin5e)
stargazer(negbin5e, type='text', title='returnquantity-NB', column.labels = 'negative binomial-IRR',
apply.coef = exp, t.auto = F, p.auto = F,
df=FALSE, digits=2, star.cutoffs = c(0.05,0.01,0.001))
###### HETEROSKEDASTICITY
gqtest(negbin5e)  # significant
bptest(negbin5e)  # significant
HWrobstder3d <- sqrt(diag(vcov(negbin5e, type='HC1')))
stargazer(negbin5e, type='text', title='Online_Returnquantity',
apply.coef = exp, t.auto = F, p.auto = F,
se=list(HWrobstder3d), column.labels = c("HW-Robust SE"),
df=FALSE, digits=2, star.cutoffs = c(0.05,0.01,0.001))
#### MODEL fit
negbin5f <- glm.nb(returnquantity ~1, data =Online_daily_prod)
lrtest(negbin5e, negbin5f)   # significant, NB model fits the data
###### CHOOSE MODEL
lrtest(poisson5f, negbin5e) # significant, NB model is better
#### Marginal Effects
meffects5d <- ggpredict(negbin5e, terms=c('time_group', 'store_group'))
ggplot(meffects5d, aes(x, predicted, color=group)) + geom_line(size=1.3) +
xlab('Time') + ylab('Return Quantity') +
scale_color_discrete(labels=c('Policy changed', 'Policy unchanged'))+
scale_x_continuous(breaks = c(0,1), labels = c('Before policy change', 'After policy change'))
#=========
# Conclusion: change of return policy will decrease online returnvalue by 20%,
#                                     will decrease return quantity by 12%
#=========
```
#### Marginal Effects
meffects5d <- ggpredict(negbin5e, terms=c('time_group', 'store_group'))
ggplot(meffects5d, aes(x, predicted, color=group)) + geom_line(size=1.3) +
xlab('Time') + ylab('Return Quantity') +
scale_color_discrete(labels=c('Policy changed', 'Policy unchanged'))+
scale_x_continuous(breaks = c(0,1), labels = c('Before policy change', 'After policy change'))
stargazer(Online_daily_prod, type='text', title='descriptive analysis',
digits=2, median=TRUE, iqr=TRUE)
###### Linear Regression
lm6b <-lm(lnsalesvalue ~ time_group*store_group*fproduct_category + avg_female + avg_age + avg_income +
avg_homeowner + avg_residency + avg_childowner, data=Online_daily_prod)
step<- stepAIC(lm6a, direction='both')
step$anova
###### Linear Regression
lm6b <-lm(lnsalesvalue ~ time_group*store_group*fproduct_category + avg_female + avg_age + avg_income +
avg_homeowner + avg_residency + avg_childowner, data=Online_daily_prod)
step<- stepAIC(lm6a, direction='both')
###### Linear Regression
lm6a <-lm(lnsalesvalue ~ time_group*store_group*fproduct_category + avg_female + avg_age + avg_income +
avg_homeowner  + avg_childowner, data=Online_daily_prod)
step<- stepAIC(lm6a, direction='both')
step$anova
step<- stepAIC(lm6a, direction='both')
step$anova
lm6b <-lm(lnsalesvalue ~ time_group*store_group*fproduct_category + avg_female + avg_age + avg_income +
avg_homeowner + avg_residency + avg_childowner, data=Online_daily_prod)
anova(lm6a, lm6b, test='Chisq')
stargazer(lm6a, type='text',title='regression result',
column.labels = 'lm6B', df=FALSE, digits=2, star.cutoffs = c(0.05,0.01,0.001))
bptest(lm6a)  #significant
gqtest(lm6a)  # significant
HWrobstder6a <- sqrt(diag(vcovHC(lm6a, type='HC1')))
stargazer(lm6a,lm6a, type='text', title='Q6- Impact on Online sales value across products',
se=list(NULL, HWrobstder6a),
column.labels = c('Normal SE', 'HW-robust SE'), df=F, digits=2, star.cutoffs = c(0.05,0.01,0.001))
##### Marginal Effects
meffects6a <- ggpredict(lm6a, terms=c('time_group','store_group','fproduct_category'))
ggplot(meffects6a, aes(x,predicted, color=group)) + geom_line(size=1.3)+
xlab('Time') + ylab('ln(Online_Salesvalue)') +
scale_color_discrete(labels=c('Policy changed', 'Policy unchanged'))+
scale_x_continuous(breaks = c(0,1), labels = c('Befoct', 'Aftoct'))+
facet_wrap(~facet,ncol=4)
online_salesvalue_pc <- list()
for (n in 1:21) {
online_salesvalue_pc[[n]] <- subset(Online_daily_prod, Online_daily_prod$fproduct_category==n)
}
model_online_salesvalue_pc<-list()
for (m in c(1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,20,21)) {
model_online_salesvalue_pc[[m]] <- lm(
lnsalesvalue ~ time_group*store_group
+ avg_female
+ avg_age
+ avg_income
+ avg_homeowner
+ avg_childowner
, data=online_salesvalue_pc[[m]]
)
}
for (n in c(1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,20,21)) {
stargazer(model_online_salesvalue_pc[[n]],type="text",digits=2,titile=paste("model_pc",n,"Results"))
}
mydata6a_18 <- subset(Online_daily_prod, fproduct_category==18)
res6a_18 <- lm(lnsalesvalue ~ time_group*store_group + avg_female + avg_age + avg_income +
avg_homeowner  + avg_childowner, data=mydata6a_18)
mydata6a_19 <- subset(Online_daily_prod, fproduct_category==19)
res6a_19 <- lm(lnsalesvalue ~ time_group*store_group + avg_female + avg_age + avg_income +
avg_homeowner  + avg_childowner, data=mydata6a_19)
########
# Online Sales Quantity
########
stargazer(Online_daily_prod, type='text', title='descriptive analysis',
digits=2, median=TRUE, iqr=TRUE)
### Multicollinearity
df6c <- Online_daily_prod[c('salesquantity','store_group','time_group', 'avg_female','avg_age','avg_income',
'avg_homeowner','avg_residency','avg_childowner')]
cor(df6a)
############# Poisson
poisson6a <- glm(salesquantity ~ time_group*store_group*fproduct_category + avg_female + avg_age + avg_income +
avg_homeowner + avg_childowner, data=Online_daily_prod, family='poisson')
poisson6 <- glm(salesquantity ~ time_group*store_group*fproduct_category + avg_female + avg_age + avg_income +
avg_homeowner + avg_childowner + avg_residency, data=Online_daily_prod, family='poisson')
anova(poisson6a, poisson6, test='Chisq')
stargazer(poisson6, type='text', title='Q6-salesquantity across products',
column.labels =c('Poisson-IRR'),
apply.coef = exp, t.auto = F, p.auto = F,
df=FALSE, digits=2, star.cutoffs = c(0.05,0.01,0.001))
#### Heteroskedasticity
bptest(poisson6)  #significant
gqtest(poisson6)  # significant
HWrobstder6b <- sqrt(diag(vcovHC(poisson6, type='HC1')))
stargazer(poisson6,poisson6, type='text', title='Q6- Impact on Online sales quantity across products',
apply.coef = exp, t.auto = F, p.auto = F,
se=list(NULL, HWrobstder6b),
column.labels = c('Normal SE', 'HW-robust SE'), df=F, digits=2, star.cutoffs = c(0.05,0.01,0.001))
##### Model Fit
poisson6c <- glm(salesquantity ~ 1, data=Online_daily_prod, family='poisson')
lrtest(poisson6, poisson6c)
negbin6a <- glm.nb(salesquantity ~ time_group*store_group*fproduct_category + avg_female + avg_age + avg_income +
avg_homeowner + avg_childowner + avg_residency, data=Online_daily_prod)
negbin6b <- glm.nb(salesquantity ~ time_group*store_group*fproduct_category + avg_female + avg_age + avg_income +
avg_homeowner + avg_childowner, data=Online_daily_prod)
#### Heteroskedasticity
bptest(poisson6)  #significant
gqtest(poisson6)  # significant
HWrobstder6b <- sqrt(diag(vcovHC(poisson6, type='HC1')))
stargazer(poisson6,poisson6, type='text', title='Q6- Impact on Online sales quantity across products',
apply.coef = exp, t.auto = F, p.auto = F,
se=list(NULL, HWrobstder6b),
column.labels = c('Normal SE', 'HW-robust SE'), df=F, digits=2, star.cutoffs = c(0.05,0.01,0.001))
##### Model Fit
poisson6c <- glm(salesquantity ~ 1, data=Online_daily_prod, family='poisson')
lrtest(poisson6, poisson6c)
negbin6a <- glm.nb(salesquantity ~ time_group*store_group*fproduct_category + avg_female + avg_age + avg_income +
avg_homeowner + avg_childowner + avg_residency, data=Online_daily_prod)
negbin6b <- glm.nb(salesquantity ~ time_group*store_group*fproduct_category + avg_female + avg_age + avg_income +
avg_homeowner + avg_childowner, data=Online_daily_prod)
lrtest(negbin6a, negbin6b) # insignificant without avg_residency is better(negbin6b)
### Heteroskedasticity
bptest(negbin6b)  #significant
gqtest(negbin6b)  # significant
HWrobstder6c <- sqrt(diag(vcovHC(negbin6b, type='HC1')))
stargazer(negbin6b,negbin6b, type='text', title='Q6- Impact on Online sales quantity across products-NB',
apply.coef = exp, t.auto = F, p.auto = F,
se=list(NULL, HWrobstder6c),
column.labels = c('Normal SE', 'HW-robust SE'), df=F, digits=2, star.cutoffs = c(0.05,0.01,0.001))
#### Model Fit
negbin6c <- glm.nb(salesquantity~1, data=Online_daily_prod)
lrtest(negbin6b, negbin6c)
#### Choose model (poisson & negative binomial)
lrtest(negbin6b, poisson6)
##### Marginal Effects
meffects6b <- ggpredict(negbin6b, terms=c('time_group','store_group','fproduct_category'))
ggplot(meffects6b, aes(x,predicted, color=group)) + geom_line(size=1.3)+
xlab('Time') + ylab('Online_SalesQuantity') +
scale_color_discrete(labels=c('Policy changed', 'Policy unchanged'))+
scale_x_continuous(breaks = c(0,1), labels = c('BefOct', 'AftOct'))+
facet_wrap(~facet,ncol=4)
online_salesquantity_pc <- list()
for (n in c(1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,20,21)) {
online_salesquantity_pc[[n]] <- subset(Online_daily_prod, Online_daily_prod$fproduct_category==n)
}
model_online_salesquantity_pc<-list()
for (m in c(1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,20,21)) {
model_online_salesquantity_pc[[m]] <- glm.nb(
salesquantity ~ time_group*store_group
+ avg_female
+ avg_age
+ avg_income
+ avg_homeowner
+ avg_childowner
, data=online_salesquantity_pc[[m]]
)
}
stargazer(model_online_salesquantity_pc[[n]],type="text",titile=paste("model_online_salesquantity_pc",n,"Results"),
apply.coef = exp, t.auto = F, p.auto = F,
digits=2,df=FALSE, star.cutoffs = c(0.05,0.01,0.001) )
########
# Online Return value
########
stargazer(Online_daily_prod, type='text', title='descriptive analysis',
digits=2, median=TRUE, iqr=TRUE)
###### Linear Regression
lm6c <-lm(lnreturnvalue ~ time_group*store_group*fproduct_category + avg_female + avg_age + avg_income +
avg_homeowner + avg_residency + avg_childowner, data=Online_daily_prod)
lm6d <-lm(lnreturnvalue ~ time_group*store_group*fproduct_category + avg_female + avg_age + avg_income +
avg_homeowner  + avg_childowner, data=Online_daily_prod)
anova(lm6c, lm6d, test='Chisq')
# insignificant, without avg_residency is better(lm6d)
lm6e <- lm(lnreturnvalue ~ time_group*store_group*fproduct_category + avg_female + avg_age + avg_income +
avg_homeowner  + avg_childowner + lnsalesvalue, data=Online_daily_prod)
anova(lm6d, lm6e, test='Chisq') # withlnsalesvalue is better (6e)
stargazer(lm6e, type='text',title='regression result',
column.labels = 'lm6e', df=FALSE, digits=2, star.cutoffs = c(0.05,0.01,0.001))
bptest(lm6e)  #significant
gqtest(lm6e)  # insignificant
HWrobstder6d <- sqrt(diag(vcovHC(lm6e, type='HC1')))
stargazer(lm6e,lm6e, type='text', title='Q6- Impact on Online return value across products',
se=list(NULL, HWrobstder6d),
column.labels = c('Normal SE', 'HW-robust SE'), df=F, digits=2, star.cutoffs = c(0.05,0.01,0.001))
##### Marginal Effects
meffects6c <- ggpredict(lm6e, terms=c('time_group','store_group','fproduct_category'))
ggplot(meffects6c, aes(x,predicted, color=group)) + geom_line(size=1.3)+
xlab('Time') + ylab('ln(Online_Returnvalue)') +
scale_color_discrete(labels=c('Policy changed', 'Policy unchanged'))+
scale_x_continuous(breaks = c(0,1), labels = c('BefOct', 'AftOct'))+
facet_wrap(~facet,ncol=4)
online_returnvalue_pc <- list()
model_online_salesvalue_pc[[m]] <- lm(
lnsalesvalue ~ time_group*store_group
+ avg_female
+ avg_age
+ avg_income
+ avg_homeowner
+ avg_childowner
, data=online_salesvalue_pc[[m]]
)
for (m in c(1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,20,21)) {
model_online_salesvalue_pc[[m]] <- lm(
lnsalesvalue ~ time_group*store_group
+ avg_female
+ avg_age
+ avg_income
+ avg_homeowner
+ avg_childowner
, data=online_salesvalue_pc[[m]]
)
}
for (n in c(1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,20,21)) {
stargazer(model_online_salesvalue_pc[[n]],type="text",digits=2,titile=paste("model_pc",n,"Results"))
}
online_salesvalue_pcHWrobstder <-list()
for (z in c(1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,20,21)) {
online_salesvalue_pcHWrobstder[[z]] <-sqrt(diag(vcov(model_online_salesvalue_pc[[z]], type='HC1')))
}
stargazer(model_online_salesvalue_pc[[n]],type="text",title=paste("model_pc",n,"Results"),
se=list(HWrobstder3d), column.labels = c("HW-Robust SE"),
df=FALSE, digits=2, star.cutoffs = c(0.05,0.01,0.001))
stargazer(model_online_salesvalue_pc[[n]],type="text",title=paste("model_pc",n,"Results"),
se=list(online_salesvalue_pcHWrobstder[[n]]), column.labels = c("HW-Robust SE"),
df=FALSE, digits=2, star.cutoffs = c(0.05,0.01,0.001))
stargazer(model_online_salesvalue_pc[[n]],type="text",title=paste("model_pc",n,"Results"),
se=list(online_salesvalue_pcHWrobstder[[n]]),
df=FALSE, digits=2, star.cutoffs = c(0.05,0.01,0.001))
stargazer(model_online_salesvalue_pc[[n]],type="text",title=paste("model_pc",n,"Results"),
se=list(online_salesvalue_pcHWrobstder[[n]]),
df=FALSE, digits=2, star.cutoffs = c(0.05,0.01,0.001))
stargazer(model_online_salesvalue_pc[[n]],type="text",digits=2,title=paste("model_pc",n,"Results"))
for (n in c(1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,20,21)) {
stargazer(model_online_salesvalue_pc[[n]],type="text",digits=2,title=paste("model_pc",n,"Results"))
}
stargazer(model_online_salesvalue_pc[[n]],type="text",digits=2,title=paste("model_pc",n,"Results"),
se=list(online_salesvalue_pcHWrobstder[[n]]))
for (n in c(1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,20,21)) {
stargazer(model_online_salesvalue_pc[[n]],type="text",digits=2,title=paste("model_pc",n,"Results"),
se=list(online_salesvalue_pcHWrobstder[[n]]))
}
